![C/C++ CI](https://github.com/skourismanolis/project/actions/workflows/c-cpp.yml/badge.svg)

# Εργασία 1 - Ανάπτυξη Λογισμικού Για Πληροφοριακά Συστήματα
#### Εμμανουήλ-Νικόλαος Σκούρης sdi1700142

## Χρήση
- Compile everything and run tests:
	```
	make
	```
- Compile only main
	```
	make main
	```
- Compile only tests
	```
	make test_runner
	```
- Run main
	```
	./main
	```
- Run tests
	```
	./test_runner
	```

## Δομές δεδομένων
Καθώς πολλές φορές γράφουμε δομές και χρειάζεται μετά να τις αλλάξουμε γιατί αλλάζει το αντικείμενο που χειρήζονται, αποφάσησα να τις φτιάξω χρησιμοποιόντας c++ templates. Είναι ποιο εύκολο έτσι να ελεγχθούν (testing) και να αναπτυχθούν ως ανεξάρτητα μέρη του προγράμματως και μετά να χρησιμοποιηθούν με την ασφάλεια και ευκολία οτι μπορούμε να αλλάξουμε την δομή χωρίς να χρειαστεί να τις αγγίξουμε.

## Function Pointers
Το hashtable για hashing function και το BK tree για distance function δεχονται εναν function pointer κατα την δημιουργία τους. Με αυτόν τον τρόπο μπορούμε εύκολα να αλλάξουμε και να τεστάρουμε διαφορετικά implementations αυτών των συναρτήσεων χωρίς να χρειάζεται να πειράξουμε τον πηγαίο κώδικά των δωμών αυτών.

## Deduplication
Για deduplication χρησιμοποίησα ενα hashtable, οι λέξεις ελέγχονται αν υπάρχουν μέσα του και αν οχι γίνεται εισαγωγή. Τέλος χρησιμοποιείται η συνάρτηση `all` του hashtable για να πάρουμε μια λίστα με τις λέξεις του hashtable (που είναι και μοναδικές). Για την σύγκρηση των λέξεων μεταξύ τους έφτιαξα μια απλή wrapper class `myString` που απλά έχει overloaded το `operator==`.

## Hashtables
Για hashing function χρησιμοποίησα το άθροισμα των γραμμάτων της λέξης % HASH_MAX, οπου το HASH_MAX ειναι #defined στο `classes/util.hpp`.

## Testing
Για το testing ήθελα να έχω ένα μοναδικό εκτελέσιμο με τα tests σε διαφορετικά αρχεία, ώστε να υπάρχει modularity, extensibility και καθαρή δομή, όπως θα απαιτούσε ενα μεγαλύτερο project. Για να το πετύχω αυτό χρειάστηκε να τροποποιήσω το `acutest.h` έτσι ώστε αντί να παίρνει μια λιστα με τα tests, να χρησιμοποιεί μια provider function που θα επιστρέφει αυτήν την λίστα. Έτσι μπορούμε να χτήσουμε την λίστα αυτή δυναμικά στην `main` (`test_runner.cpp`).

Ο τελικός σκοπός ήταν κάθε αρχείο να παρέχει μια λίστα απο tests για τα οποία δεν γνωρίζει η main, το οποίο επιτεύχθει αλλα με ένα πρόβλημα:

Κάθε test suite (δλδ αρχείο `tests/*.cpp`) πρέπει να κάνει include το `acutest.h` για να εχει πρόσβαση στις testing συναρτήσεις του, όπως και το entrypoint (`test_runner.cpp`). Άν σπάγαμε κάθε test suite στο δικό του compilation unit (δηλαδή κάνοντάς τα ξεχωριστά compile και μετά όλα μαζί link) έχουμε το πρόβλημα του οτι υπάρχουν >1 definitions των συναρτήσεων και μεταβλητών του `acutest`, αφού το αρχείο `acutest.h` δεν περιέχει μόνο τα declarations αλλά και τα definitions. Για αποφευχθεί αυτό δυστιχώς χρειάστηκε να γίνουν compile ολα μαζί και στο entry point να γινουν include τα αρχεία `tests/*.cpp`.

Σημείωση: Η χρήση του `acutest.h` με τις τροποποιήσεις του περιγράφεται στα σχόλιά του.

## Υλοποίηση
Υλοποιήθηκε σε c++11 χρησιμοποιόντας g++ 9.3.0, Ubuntu 20.04 LTS σε WSL2 και Visual Studio Code.
